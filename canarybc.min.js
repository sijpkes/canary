function getElementIndex(e,n){var a=0;__J(n).each(function(n){return current=__J(this).text().length(),a+=current,a>e?n:void 0})}function run(e,n){clearTimeout(domc),console.log("Running scan..."),0===__J("#plagcheck").length&&__J("body").append('<div id="plagcheck"></div>');var a=e.split(" "),r=[],t=0,c="";console.log("PARTS: "+a),e.length>55&&(__J(a).each(function(){c.length<55?c+=" "+this:(r[t]=c.replace(/\s+/g," "),t++,c=this)}),r.length<1&&a.length>0&&(r[0]={index:0,value:c})),search(r,n),domc=setTimeout(checkDOMChanged(!0),1e3)}function checkDOMChanged(e){"undefined"==typeof e&&(e=!1),canary.ifr=__J("#blogEntry_desc_text_ifr").contents(),canary.tmceContent=__J(canary.ifr).find("#tinymce").contents();var n=__J(canary.tmceContent).text(),a=__J(canary.ifr).find("#tinymce").find("*");e===!0&&(lastStr=n,console.log("Resetting check...")),n.length-lastSearchedStr.length>55&&(lastStr!==n&&(console.log("Changed: "+n),console.log("Last search str: "+lastSearchedStr+" DIFF: "+(n.length-lastSearchedStr.length)),run(n,a),lastSearchedStr=n),lastStr=n),domc=setTimeout(checkDOMChanged,1e3)}function parseResult(e,n,a){if("undefined"!=typeof n){var r=__J(a).clone().wrap("<div/>").parent(),t=(__J(r).contents(),decodeURIComponent(e),"string"==typeof n?JSON.parse(n):n,""),c=n[0];if(canary.prevLink=c.link,"undefined"==typeof c)return void console.log("No results");console.log(c),parseFloat(c.perc)>20&&(t="#FFCBA4"),parseFloat(c.perc)>50&&(t="orange"),parseFloat(c.perc)>80&&(t="red"),console.log(t);var o=[];""!=t&&__J(a).each(function(e,n){if(o.push(n),-1==o.indexOf(__J(this).parent())){var a=__J(n).html();if(a.length>0){var r=a.replace(/\s+/g,""),s=c.phrase.replace(/\s+/g,""),l=r.indexOf(s);if(console.log("ind: "+l+" "+s+"\n\n<<< FOR >>>\n"+r),-1!=l){var i="_can"+e;__J(n).attr("id",i),"undefined"==typeof canary.markMap[i]&&(canary.markMap[i]={maps:[]}),canary.markMap[i].maps.push({index:l,res:c,color:t})}}}}),console.log(canary.markMap);for(var s in canary.markMap){canary.ifr=__J("#blogEntry_desc_text_ifr").contents();var l;if(l=0==__J("#plagcheck").html().length?__J(canary.ifr).find("#tinymce #"+s).html():__J("#plagcheck").html(),console.log(canary.tmceContent),console.log("CONTENT==== #"+s),console.log(l),"undefined"!=typeof l)for(var i=0;i<canary.markMap[s].maps.length;i++){var d=canary.markMap[s].maps[i];console.log("==== MAP ===="),console.log(d);var h="<a href='"+d.res.link+"' style='color: "+t+"; cursor: pointer;' title='"+d.res.perc+"% match with "+d.res.displayLink+"'>",p="</a>",_=l.indexOf(d.res.phrase),g=l.slice(0,_),u=l.slice(_+d.res.phrase.length,l.length);__J("#plagcheck").html(g+h+d.res.phrase+p+u)}}}}function search(e,n){var a="undefined"!=typeof canary.prevLink&&canary.prevLink.length>0?"&pdl="+encodeURIComponent(canary.prevLink):"";__J.ajax({url:base+"p_search.php?q="+encodeURIComponent(e[searchIndex])+a,type:"GET",async:!1,dataType:"jsonp",jsonpCallback:"check",success:function(a){console.log(a),"undefined"!=typeof a.results&&(parseResult(e[searchIndex],a.results,n),searchIndex++,searchIndex<e.length?search(e,n):searchIndex=0)},error:function(){alert("Error")}})}var canary=canary?canary:{},lastStr="",lastSearchedStr="",domc=null,searchIndex=0;canary.markMap=[],__J(".textboxtable").bind("mouseover","body#tinymce",function(){null===domc?(domc=setTimeout(checkDOMChanged,1e3),console.log("dom checker attached")):__J(".textboxtable body#tinymce").unbind("mouseover")});
//# sourceMappingURL=canarybc.min.js.map
